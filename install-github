#!/usr/bin/env bash

pushd_quiet () { builtin pushd "$@" > /dev/null; }
popd_quiet () { builtin popd > /dev/null; }

IFS=':' read -ra path_a <<< "$PATH"
for name in "${path_a[@]}"; do
  if [[ -w "$name" && "$name" == */bin && -w "${name%/bin}" ]]; then
    destdir="${name%/bin}"
  fi
done
if [ -z ${destdir+set} ]; then
  destdir="$HOME/.local"
  need_path=true
fi

pushd_quiet /tmp
echo "Downloading package from github..."
rm -fr lh-install
git clone https://github.com/franko/lhelper.git lh-install
pushd_quiet lh-install

bash install "$destdir"

echo "Lhelper successfully installed"
if [ ! -z ${need_path+set} ]; then
  echo "To use lhelper add the directory \"$destdir\" to your PATH."
fi

popd_quiet
rm -fr lh-install
popd_quiet

